<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>FeatureLayer - 4.1</title>

  <link rel="stylesheet" href="https://js.arcgis.com/4.1/esri/css/main.css">
  <script src="https://js.arcgis.com/4.1/"></script>

  <style>
    html,
    body,
    #viewDiv {
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
    }
  </style>

  <script>
    require([
        "esri/Map",
        "esri/views/SceneView",

        "esri/layers/FeatureLayer",
          "esri/renderers/UniqueValueRenderer",
      "esri/symbols/ExtrudeSymbol3DLayer",
      "esri/symbols/PolygonSymbol3D",
      "esri/symbols/SimpleFillSymbol",

        "dojo/domReady!"
      ],
      function(
        Map, 
        SceneView,
        FeatureLayer,
        UniqueValueRenderer,
      ExtrudeSymbol3DLayer, 
      PolygonSymbol3D,
      SimpleFillSymbol
      
        
      ) {

        var map = new Map({
          basemap: "streets"
        });
        
        var size = 100

        var view = new SceneView({
          container: "viewDiv",
          map: map,
zoom: 14,
center: [-79.0558, 35.9132]
        });

        /********************
         * Add feature layer
         ********************/
         
         var symbol = new PolygonSymbol3D({
  symbolLayers: [new ExtrudeSymbol3DLayer({
    size: size,  // 100,000 meters in height
    //material: { color: size > 300 ? 'red' : 'blue' }
  })]
});

var template = {
  title: "Marriage in NY, Zip Code: {ZIP}",
  // Four fields are used in this template. The value of the selected feature will be
  // inserted in the location of each field name below
  content: "<p>As of 2015, <b>{MARRIEDRATE}%</b> of the population in this zip code is married.</p>" +
    "<ul><li>{MARRIED_CY} people are married</li>" +
    "<li>{NEVMARR_CY} have never married</li>" +
    "<li>{DIVORCD_CY} are divorced</li><ul>"
};

//var citiesRenderer = new UniqueValueRenderer({
  //symbol: symbol
//});
var renderer = new UniqueValueRenderer({
  field: "Address",
  defaultSymbol: new SimpleFillSymbol()
});

renderer.addUniqueValueInfo("high",
  new SimpleFillSymbol({
    color: "red"
  })
);

renderer.addUniqueValueInfo("mid",
  new SimpleFillSymbol({
    color: "green"
  })
);

renderer.addUniqueValueInfo("low",
  new SimpleFillSymbol({
    color: "yellow"
  })
);
renderer.visualVariables = [{
  type: "opacityInfo",
  field: "Address",
  normalizationField: "SQ_KM",
  // features with 30 ppl/sq km or below are assiged the first opacity value
  stops: [{ value: 100, opacity: 0.15 },
        { value: 1000, opacity: 0.90 }]
}];

        // Carbon storage of trees in Warren Wilson College.
        var featureLayer = new FeatureLayer({
          url: "http://services7.arcgis.com/cS890GsOFd26sODz/arcgis/rest/services/UNCV2/FeatureServer/0",
          renderer:renderer
        });
        
        featureLayer.popupTemplate = template;

        map.add(featureLayer);

      });
      
      
  </script>
</head>

<body>
  <div id="viewDiv"></div>
</body>

</html>